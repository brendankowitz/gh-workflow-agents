name: 'GH-Agency Research Agent'
description: |
  Proactive codebase health monitoring and research.

  This agent autonomously analyzes your repository for:
  - Security vulnerabilities and advisories
  - Outdated dependencies (disk-based manifest scanning)
  - Technical debt (codebase scanning for complexity, TODOs, architecture issues)
  - Industry trends and feature suggestions (AI-powered, vision-driven)
  - Open issue health (stale issues, duplicates, close candidates)

  It can automatically create actionable issues for recommendations
  that align with your project's vision.

  Requires COPILOT_GITHUB_TOKEN environment variable set with a GitHub PAT
  that has 'Copilot Requests: Read' permission for AI-powered analysis.

  Required workflow permissions:
    permissions:
      issues: write        # Create and update issues
      contents: read       # Read repository content (README, VISION.md, etc.)
      security-events: read # Read Dependabot alerts (optional)

author: 'Brendan Kowitz'

branding:
  icon: 'search'
  color: 'green'

inputs:
  github-token:
    description: 'GitHub token for API access (issues, repos, security). Must have write access to issues.'
    required: true
  copilot-token:
    description: 'GitHub PAT with Copilot Requests permission (falls back to COPILOT_GITHUB_TOKEN env var)'
    required: false
  model:
    description: 'AI model to use for analysis'
    required: false
    default: 'claude-sonnet-4.5'
  output-type:
    description: 'Where to output the summary report (issue, wiki, artifact)'
    required: false
    default: 'issue'
  focus-areas:
    description: 'Comma-separated list of areas to analyze (dependencies, security, technical-debt, industry-research, issue-review)'
    required: false
    default: 'dependencies,security,technical-debt,industry-research,issue-review'
  create-actionable-issues:
    description: 'Automatically create individual issues for actionable recommendations'
    required: false
    default: 'false'
  min-priority-for-issue:
    description: 'Minimum priority level for creating individual issues (low, medium, high, critical)'
    required: false
    default: 'high'
  issue-number:
    description: 'Issue number to research (for issue-focused mode, triggered by triage agent)'
    required: false
  stale-days-threshold:
    description: 'Days without activity before issue is considered stale'
    required: false
    default: '30'
  max-scan-files:
    description: 'Maximum source files to scan for technical debt (0 = unlimited)'
    required: false
    default: '500'
  mode:
    description: 'Research mode: scheduled (default weekly report) or issue-focused (targeted analysis for a specific issue)'
    required: false
    default: 'scheduled'

outputs:
  report:
    description: 'Full research report as JSON'
  dependency-updates:
    description: 'Number of dependency updates available'
  technical-debt-items:
    description: 'Number of technical debt items identified'
  security-advisories:
    description: 'Number of open security advisories'
  issues-created:
    description: 'Number of actionable issues created'
  issue-numbers:
    description: 'Comma-separated list of created issue numbers'
  recommended-action:
    description: 'Next action recommendation (e.g., assign-to-agent for issue-focused mode)'
  issue-number:
    description: 'Issue number that was researched (for chaining to coding agent)'

runs:
  using: 'node20'
  main: 'dist/index.js'
